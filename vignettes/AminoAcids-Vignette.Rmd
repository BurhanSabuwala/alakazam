---
title: 'Alakazam: Analysis of aminoacid chemical properties'
author: "Jason Anthony Vander Heiden"
date: '`r Sys.Date()`'
output:
  pdf_document:
    dev: pdf
    fig_height: 4
    fig_width: 7.5
    highlight: pygments
    toc: yes
  html_document:
    fig_height: 4
    fig_width: 7.5
    highlight: pygments
    theme: readable
    toc: yes
geometry: margin=1in
fontsize: 11pt
vignette: |
  %\VignetteIndexEntry{Analysis of aminoacid chemical properties} %\VignetteEngine{knitr::rmarkdown} %\usepackage[utf8]{inputenc}
---



# Load Change-O data #

A small example Change-O tab-delimited database file is included in the 
`alakazam` package. 

```{r, eval=TRUE, warning=FALSE, message=FALSE}
library(alakazam)

# Load Change-O file
file <- system.file("extdata", "changeo_demo.tab", package="alakazam")
db <- readChangeoDb(file)
colnames(db)
```

# Calculate the properties of amino acid sequences #

Multiple amino acid chemical properties can be obtained with the function `aminoAcidProperties`. The available properties are `length`, `hydrophobicity`, `bulkiness`, `polarity`, aliphatic index (`aliphatic`), net charge (`charge`), acidic residue content (`acidic`), basic residue content (`basic`), and aromatic reside content (`aromatic`).

In this example we calculate all the available amino acid properties of the DNA sequences found in column `JUNCTION` of the Change-O file we previously loaded. We use `nt = TRUE` to specify we have DNA sequences that will need to be translated into amino acid sequences prior calculating the properties. We add the prefix `CDR3` to the output column names.

```{r, eval=TRUE, warning=FALSE}
db_props <- aminoAcidProperties(db, seq="JUNCTION", nt=TRUE,
                            trim=FALSE, label="CDR3")
## Several columns have been added, starting with the prefix CDR3
colnames(db_props)
db_props[1:5,15:23]
```

## Obtaining properties individually ##

The Grand Average of Hydrophobicity (GRAVY) index can be obtained with  the function `aminoAcidProperties` setting `properties="gravy"`. By default, it will use the method of Kyte & Doolittle, excluding from the calculations those position in the amino acid sequence considered non-informative (.,-,*,X).

```{r, eval=TRUE, warning=FALSE}
db_g <- aminoAcidProperties(db, seq="JUNCTION", properties="gravy",
                          nt=TRUE,trim=FALSE, label="CDR3")
## Several columns have been added, starting with the prefix CDR3
colnames(db_g)
db_g[1:5,15]
```

## Using user defined scales ##

It is possible to use user provided scales. Here we demonstrate how to use the Kidera et al, 1985 scores from the `seqinr` package for the calculation of the *GRAVY index*. 

```{r, eval=TRUE, warning=FALSE, message=FALSE}
library(seqinr)
data(aaindex)
h <- aaindex[["KIDA850101"]]$I
# Rename the score vector to use single-letter codes
names(h) <- translateStrings(names(h), AA_TRANS)
db_g_h <- aminoAcidProperties(db, seq="JUNCTION", properties="gravy", nt=TRUE, trim=FALSE, label="CDR3", hydropathy=h)
colnames(db_g_h)
db_g_h[1:5,15]
```

To calculate the *average bulkiness* of amino acids using the Grantham, 1974 side chain volumn scores from the seqinr package and pH=7:

```{r, eval=TRUE, warning=FALSE, message=FALSE}
x <- aaindex[["GRAR740103"]]$I
# Rename the score vector to use single-letter codes
names(x) <- translateStrings(names(x), AA_TRANS)
db_props_bulk <- aminoAcidProperties(db, seq="JUNCTION", properties="bulk", nt=TRUE, trim=FALSE, label="CDR3", bulkiness=x, pH=7.0)
colnames(db_props_bulk)
db_props_bulk[1:5,15]
```

# R Session #

```{r}
sessionInfo()
```
